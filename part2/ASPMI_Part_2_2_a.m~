% clc; clear all;
load('x_ma.mat')

realisations = 1;
N = 1000;
% var = 0.5;
% factor = sqrt(var);
% noise = factor*randn(N,realisations);
% 
% b = [1 0.9];
% a = [1];
% x_ma = filter(b,a,noise);

noise_delay = zeros(N+1,realisations);
for i = 1:realisations
    noise_delay(:,i) = vertcat(0, noise(:,i)); 
end

x_hat_1 = zeros(N,1);
x = zeros(N,1);
x2 = zeros(N,1);
x3 = zeros(N,1);
e1 = zeros(N,1);

phi_MX = zeros(N,realisations);
mu_MX = zeros(N,realisations);
rho = 0.001;
alpha = 0.8;
w11 = 0;
w1 = zeros(N,realisations);


% Matthews & Xie
for i = 1:realisations
    for n = 1:10
        if n>1
            phi_MX(n,i) = e1(n-1,i)*x;
        end
        x = noise_delay(n,i);
        x_hat_1(n,i) = (w11.')*x;
        e1(n,i) = x_ma(n,i) - x_hat_1(n,i);  
        w11 = w11 + mu_MX(n,i)*e1(n,i)*x;
        w1(n,i) = w11;
        disp(w11)
        mu_MX(n+1,i) = mu_MX(n,i) + rho*e1(n,i)*x'*phi_MX(n,i);
    end
     w11 = 0;
end 
   
%    mean_w1 = mean(w1,2);
%    figure
%    plot(mean_w1);

 