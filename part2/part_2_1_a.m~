clc; clear all;

clc; clear all;
load('font_size.mat')

a1 = 0.1;
a2 = 0.8;
sigma = 0.25;
mu1 = 0.05;
mu2 = 0.01; 
order = 2;

x0 = 0;
coef = [0.1,0.8];
num_samples = 1000;
noise_variance = 0.25;

%x(n) = a1x(n ? 1) + a2x(n ? 2) + ?(n)
model = arima('Constant',randn(1)*noise_variance,'AR',{a1,a2},'Variance',noise_variance);
x = simulate(model,num_samples);

[~, error_5, w1] = lms_ar_2(x, mu1, order);
[~, error, w2] = lms_ar(x, mu1, order);
[~, error_1, ~] = lms_ar_2(x, mu2, order);

num_realisations = 100;
e_realisations_5 = zeros(num_samples,num_realisations);
e_realisations_1 = zeros(num_samples,num_realisations);
for i=1:num_realisations
    temp_x = simulate(model,num_samples);
    [~,e_realisations_5(:,i),~] = lms_ar(temp_x, mu1, 2);
    [~,e_realisations_1(:,i),~] = lms_ar(temp_x, mu2, 2);
end

mean_error_5 = mean(e_realisations_5,2);
mean_error_1 = mean(e_realisations_1,2);

figure('Renderer', 'painters', 'Position',[200,200,1000,600])
subplot(1,2,1)
plot(10*log10(error_5.^2))
plot(10*log10(error_5.^2))
title('LMS Estimator, mu=0.05','FontSize',title_font_size)
xlabel('n','FontSize',x_label_font_size)
ylabel('Squared Error (dB)','FontSize',y_label_font_size)
grid on


figure(2)
plot(10*log10(error.^2))

figure(1,'Renderer', 'painters', 'Position',[200,200,1000,600])
for i = 1:num_realisations
    p1 = plot(10*log10(e_realisations_5(:,i)), "c");
    hold on
end   

title('LMS Estimator, mu=0.05','FontSize',title_font_size)
xlabel('n','FontSize',x_label_font_size)
ylabel('Squared Error (dB)','FontSize',y_label_font_size)
grid on
p2 = plot(sine_biased_fs(i,:), 10*log10(mean_Pxx), 'b');
h = [p1(1);p2];
legend(h, 'Realisations', 'Mean of Realisations','Location','southwest','FontSize',legend_font_size)