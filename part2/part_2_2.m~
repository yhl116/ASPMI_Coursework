% load('font_size.mat')
load('x_ma.mat')

realisation = 1;
N = 1000;
% noise_variance = 0.5;
% sd = sqrt(noise_variance);
% % noise = sd*randn(N, realisation);
% noise = sd*randn(N, 1);
order = 2;
% 
% b = [1 0.9];
% a = 1;
% x_ma = filter(b,a,noise);

x_hat_pad = zeros(N+order+1,1);
error_pad = zeros(1,N+order+1);
x_pad = vertcat(zeros(order+1,1),x_ma);
mu_pad = zeros(N+2+order,1);
w = zeros(order,N+2+order);
rho = 0.001;
noise_pad = vertcat(zeros(order+1,1),noise);

% noise_delay = zeros(N+1, realisation);
% for i = 1:realisation
%     noise_delay(:,i) = vertcat(0,noise(:,i));
% end

for i = 2+order:1001+order
    x_vec = noise_pad(i-1:-1:i-order);
    x_hat_pad(i) = (w(:, i).')*x_vec;
    error_pad(i) = x_pad(i) - x_hat_pad(i);
    
    phi = error_pad(i-1) * noise_pad(i-2);
    mu_pad(i+1) = mu_pad(i) + rho * error_pad(i) * x_vec.'* phi;
    a = mu_pad(i)*error_pad(i)*x_vec;
    disp(w(:, i))
    w(:, i+1) = w(:, i) + mu_pad(i)*error_pad(i)*x_vec;
    
end

% [x_hat, error, w] = lms_gass(x_ma, noise, 0.001, 2)

figure
plot(w)
